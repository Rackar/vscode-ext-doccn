(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{293:function(s,t,a){"use strict";a.r(t);var n=a(17),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"示例-调试适配器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#示例-调试适配器"}},[s._v("#")]),s._v(" 示例-调试适配器")]),s._v(" "),a("p",[s._v("虽然VS Code实现了一个原生的调试界面，但是它不能直接和调试器通信，而是依赖于"),a("em",[s._v("调试插件")]),s._v("实现调试和运行时的功能特性。")]),s._v(" "),a("p",[s._v("这些调试插件各不相同，主要是因为他们的实现并不运行在扩展主机中，而是作为一个分离的独立程序。我们称这些调试插件为"),a("em",[s._v("适配器")]),s._v("是因为他们能“适配”API、具体的调试器，或者由VS Code定义的"),a("strong",[s._v("调试适配器协议")]),s._v("(DAP)。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/Microsoft/vscode-docs/master/docs/extensions/images/example-debuggers/extensibility-architecture.png",alt:"适配器运行框架"}})]),s._v(" "),a("p",[s._v("将调试适配器作为单独的运行程序有两方面的原因：第一，对于适合的调试器或者运行时，有其对应的语言来实现；第二，一个独立的程序能运行于底层调试器或者运行时上，也更轻松地运行在特权模式中。")]),s._v(" "),a("p",[s._v("为了避免本地防火墙的问题，VS Code依靠stdin/stdou和适配器通信，而不是sockets等的通信流行机制。")]),s._v(" "),a("p",[s._v("每个调试器插件定义了一种调试"),a("code",[s._v("类型")]),s._v("，而且会被VS Code的启动配置使用。当调试器session结束，调试器也会关闭。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/Microsoft/vscode-docs/master/docs/extensions/images/example-debuggers/debug-arch.png",alt:""}})]),s._v(" "),a("p",[s._v("VS Code自带Node.js的调试插件。你也可以在"),a("a",{attrs:{href:"https://marketplace.visualstudio.com/vscode/Debuggers",target:"_blank",rel:"noopener noreferrer"}},[s._v("插件市场"),a("OutboundLink")],1),s._v("找到更多调试插件，本篇教程接下来会告诉你怎么开发一个调试器插件。")]),s._v(" "),a("h2",{attrs:{id:"插件mock-debug"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#插件mock-debug"}},[s._v("#")]),s._v(" 插件Mock Debug")]),s._v(" "),a("hr"),s._v(" "),a("p",[s._v("从零开始做一个调试适配器对本篇教程来说实在太重了。因此我们会从一个简单的教学适配器开始，这个模拟的调试插件支持步进，继续，断点，异常捕捉和变量审查，但它并不会真的连接到调试器上。")]),s._v(" "),a("p",[s._v("不过在深入开发模拟调试器之前，我们先安装一个插件市场上的"),a("a",{attrs:{href:"https://marketplace.visualstudio.com/items/andreweinand.mock-debug",target:"_blank",rel:"noopener noreferrer"}},[s._v("预编译版本"),a("OutboundLink")],1),s._v("来玩玩：")]),s._v(" "),a("ul",[a("li",[s._v("切换到"),a("em",[s._v("插件")]),s._v("侧边栏，输入“mock”然后找到Mock Debug插件。")]),s._v(" "),a("li",[s._v("安装然后重启VS Code")])]),s._v(" "),a("p",[s._v("试试Mock Debug吧：")]),s._v(" "),a("ul",[a("li",[s._v("创建一个空文件夹"),a("code",[s._v("mock test")]),s._v("，然后用VS Code打开")]),s._v(" "),a("li",[s._v("新建"),a("code",[s._v("readme.md")]),s._v("，然后输入几行文字")]),s._v(" "),a("li",[s._v("切换到"),a("em",[s._v("调试")]),s._v("侧边栏，然后按齿轮⚙按钮")]),s._v(" "),a("li",[s._v("VS Code会让你选择“environment”，然后创建一个默认的启动配置文件。选择“Mock Debug”。")]),s._v(" "),a("li",[s._v("按下绿色的开始按钮，然后进入我们的"),a("code",[s._v("readme.md")]),s._v("文件")])]),s._v(" "),a("p",[s._v("调试会话（debug session）就开始了，你可以按“步进（step）”，设置断点，捕捉异常（如果文本中出现"),a("code",[s._v("exception")]),s._v("字样）")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/Microsoft/vscode-docs/master/docs/extensions/images/example-debuggers/mock-debug.gif",alt:""}})]),s._v(" "),a("p",[s._v("那么现在我们要正式学习Mock Debug示例了，我们建议你先删除这个插件。")]),s._v(" "),a("h2",{attrs:{id:"mock-debug开发设置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mock-debug开发设置"}},[s._v("#")]),s._v(" Mock Debug开发设置")]),s._v(" "),a("hr"),s._v(" "),a("p",[s._v("接下来让我们获取源码，在VS Code中开始开发吧：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone https://github.com/Microsoft/vscode-mock-debug.git\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" vscode-mock-debug\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("打开项目文件夹"),a("code",[s._v("vscode-mock-debug")]),s._v("，看看里面有什么：")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("package.json")]),s._v(" mock-debug插件的配置清单\n"),a("ul",[a("li",[s._v("列出了插件的发布内容配置点")]),s._v(" "),a("li",[a("code",[s._v("complie")]),s._v("脚本用于编译Typescript到"),a("code",[s._v("out")]),s._v("文件夹中，"),a("code",[s._v("watch")]),s._v("则是侦听后续的源码变动")]),s._v(" "),a("li",[a("code",[s._v("vscode-debugprotocol")]),s._v("、"),a("code",[s._v("vscode-debugadapter")]),s._v(" 、"),a("code",[s._v("vscode-debugadapter-testsupport")]),s._v("是NPM模块，简化了基于node的调试适配器开发工作")])])]),s._v(" "),a("li",[a("code",[s._v("src/mockRuntime.ts")]),s._v(" 提供了简单API的虚拟运行时")]),s._v(" "),a("li",[a("code",[s._v("src/mockDebug.ts")]),s._v("适配代码运行时到调试适配器协议中，你能在这个文件中找到各种各样的调试适配器协议和请求。")]),s._v(" "),a("li",[s._v("因为调试插件的实现就在调试适配器中，所以我们就完全没有编写平常要求的"),a("em",[s._v("插件")]),s._v("代码的必要了（如：运行在扩展主机环境的代码），不过Mock Debug有一个小的"),a("code",[s._v("src/extension.ts")]),s._v("文件，这个文件描述了一个调试插件都能做些什么。")])]),s._v(" "),a("p",[s._v("现在构建然后加载Mock Debug插件，选择"),a("strong",[s._v("插件")]),s._v("加载配置，然后按下"),a("code",[s._v("F5")]),s._v("，一开始，全部的Typescript编译会进入编译，然后输出到"),a("code",[s._v("out")]),s._v("文件夹中。全部构建完成后，会启动一个"),a("code",[s._v("watch task")]),s._v("用于监听你所作的任何改动。")]),s._v(" "),a("p",[s._v("之后会弹出一个新的VS Code窗口“[扩展开发主机]”，Mock Debug插件就运行在调试模式中。在这个窗口中打开"),a("code",[s._v("mock test")]),s._v("，再打开"),a("code",[s._v("readme.md")]),s._v("文件，"),a("code",[s._v("F5")]),s._v("启动调试会话。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/Microsoft/vscode-docs/master/docs/extensions/images/example-debuggers/debug-mock-session.png",alt:""}})]),s._v(" "),a("p",[s._v("现在插件已经启动在调试模式中了，你可以在"),a("code",[s._v("src/extension.ts")]),s._v("打断点，但是就如我之前所说，这个文件没有什么有意思的代码，真正重要的部分都在调试适配器中。")]),s._v(" "),a("p",[s._v("想要调试"),a("em",[s._v("调试适配器")]),s._v("本身，我们必须首先运行在调试模式中。运行调试适配器服务，然后配置VS Code连接上就好了。选中调试面板，从下拉面板中加载"),a("code",[s._v("Server")]),s._v("配置文件，然后按下绿色的开始按钮。")]),s._v(" "),a("p",[s._v("因为我们已经激活了一个插件的调试会话，VS Code调试器界面现在进入了一个多会话模式，我们也能从调试窗口中看到"),a("strong",[s._v("Extention")]),s._v("和"),a("strong",[s._v("Server")]),s._v("的调用栈视图：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/Microsoft/vscode-docs/master/docs/extensions/images/example-debuggers/debug-extension-server.png",alt:""}})]),s._v(" "),a("p",[s._v("现在我们可以调试2个插件了，同时模拟调试适配器。使用"),a("strong",[s._v("Extension + Server")]),s._v("的启动配置文件可以更快到达这一步。我们在"),a("a",{attrs:{href:"/extension-authoring/example-debug-adapter?id=%E5%8F%AF%E9%80%89%E6%96%B9%E6%A1%88%EF%BC%9A%E5%BC%80%E5%8F%91%E4%B8%80%E4%B8%AA%E8%B0%83%E8%AF%95%E6%8F%92%E4%BB%B6"}},[s._v("下面")]),s._v("提供了一个更为简单的调试"),a("strong",[s._v("插件")]),s._v("和"),a("strong",[s._v("调试适配器")]),s._v("的方案。")]),s._v(" "),a("p",[s._v("那么回到正题，我们现在给"),a("code",[s._v("src/mockDebug.ts")]),s._v("的"),a("code",[s._v("launchRequest(...)")]),s._v("方法开头添加一个断点，最后在"),a("em",[s._v("启动配置")]),s._v("中添加"),a("code",[s._v("debugServer")]),s._v("和"),a("code",[s._v("4711")]),s._v("端口将mock debugger连接到调试适配服务器。")]),s._v(" "),a("div",{staticClass:"language-typescript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-typescript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"version"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0.2.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"configurations"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mock"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"request"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"launch"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mock test"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"program"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"${workspaceFolder}/readme.md"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"stopOnEntry"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"debugServer"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4711")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("p",[s._v("如果你现在加载了这份调试配置，VS Code就不会将mock debug适配器作为分离进程启动，而是直接连接到已启动的服务器端口"),a("code",[s._v("4711")]),s._v("上，然后你就可以在"),a("code",[s._v("launchRequest")]),s._v("上打断点了。")]),s._v(" "),a("p",[s._v("在这个步骤之后，你就可以轻松地编辑，编译和调试Mock Debug项目了。")]),s._v(" "),a("p",[s._v("但是真正的工作现在才开始：你需要把"),a("code",[s._v("src/mockDebug.ts")]),s._v("和"),a("code",[s._v("src/mockRuntime.ts")]),s._v('中的关于"mock"的实现替换成真正和'),a("em",[s._v("调试器")]),s._v("或者"),a("em",[s._v("运行时")]),s._v("通信的代码，你首先可能需要理解"),a("a",{attrs:{href:"https://code.visualstudio.com/docs/extensionAPI/api-debugging",target:"_blank",rel:"noopener noreferrer"}},[s._v("调试适配器协议"),a("OutboundLink")],1),s._v("。")]),s._v(" "),a("h2",{attrs:{id:"剖析调试插件的package-json"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#剖析调试插件的package-json"}},[s._v("#")]),s._v(" 剖析调试插件的package.json")]),s._v(" "),a("hr"),s._v(" "),a("p",[a("code",[s._v("package.json")]),s._v("文件除了提供调试器所需的调试适配器和调试插件的实现细节之外，这个文件还包括了各式各样和调试相关的"),a("em",[s._v("内容配置点")]),s._v("。")]),s._v(" "),a("p",[s._v("我们现在就来仔细看看Mock Debug的"),a("code",[s._v("package.json")])]),s._v(" "),a("p",[s._v("就像每个VS Code插件一样，"),a("code",[s._v("package.json")]),s._v("声明了基本的插件属性如"),a("strong",[s._v("name")]),s._v("，"),a("strong",[s._v("publisher")]),s._v("，"),a("strong",[s._v("version")]),s._v("。而"),a("strong",[s._v("categories")]),s._v("帮助我们能更快地在插件市场找到它。")]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mock-debug"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"displayName"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Mock Debug"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"version"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0.24.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"publisher"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"..."')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"description"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Starter extension for developing debug adapters for VS Code."')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"author"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"..."')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"email"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"..."')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"engines"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"vscode"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"^1.17.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"node"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"^7.9.0"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"icon"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"images/mock-debug-icon.png"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"categories"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Debuggers"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"contributes"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"breakpoints"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"language"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"markdown"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"debuggers"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mock"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"label"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Mock Debug"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"program"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./out/mockDebug.js"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"runtime"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"configurationAttributes"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"launch"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"required"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"program"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"properties"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                        "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"program"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"string"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"description"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Absolute path to a text file."')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"default"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"${workspaceFolder}/${command:AskForProgramName}"')]),s._v("\n                        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                        "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"stopOnEntry"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"boolean"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"description"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Automatically stop after launch."')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"default"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n                        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"initialConfigurations"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mock"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"request"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"launch"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Ask for file name"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"program"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"${workspaceFolder}/${command:AskForProgramName}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"stopOnEntry"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"configurationSnippets"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"label"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Mock Debug: Launch"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"description"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A new configuration for launching a mock debug program"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"body"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                        "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mock"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                        "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"request"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"launch"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                        "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"${2:Launch Program}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                        "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"program"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"^\\"\\\\${workspaceFolder}/${1:Program}\\""')]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"variables"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"AskForProgramName"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"extension.mock-debug.getProgramName"')]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"activationEvents"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"onDebug"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"onCommand:extension.mock-debug.getProgramName"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br"),a("span",{staticClass:"line-number"},[s._v("77")]),a("br"),a("span",{staticClass:"line-number"},[s._v("78")]),a("br"),a("span",{staticClass:"line-number"},[s._v("79")]),a("br"),a("span",{staticClass:"line-number"},[s._v("80")]),a("br")])]),a("p",[s._v("现在我们看看调试插件所需的**发布内容配置（contributes）**部分。")]),s._v(" "),a("p",[s._v("第一个是"),a("strong",[s._v("breakpoints")]),s._v("内容配置点，它列出了支持设置断点的语言，没有这个配置点的话，我们就不能在Markdown文件里设置断点了。")]),s._v(" "),a("p",[s._v("第二个是"),a("strong",[s._v("debuggers")]),s._v("部分，这里给出了一个调试器，也就是"),a("strong",[s._v("type")]),s._v('描述的"mock"。用户可以在选择加载调试配置文件的时候看到这个type。可选的'),a("strong",[s._v("label")]),s._v("属性作为type的别称最后会显示在界面上。")]),s._v(" "),a("p",[s._v("既然调试插件用了调试适配器，所以它的相对路径可以在"),a("strong",[s._v("program")]),s._v("中定义。为了使插件自包含，应用必须在插件文件夹内。为了方便起见，我们把这个应用所在的文件夹命名为"),a("code",[s._v("out")]),s._v("和"),a("code",[s._v("bin")]),s._v("，不过你想用别的名字也随便。")]),s._v(" "),a("p",[s._v("因为让VS Code运行在不同的平台上，所以我们的调试适配程序也必须支持不同的平台，所以我们有了下列选项：")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("如果程序是平台无关的，如：程序需要一个统一的运行时支持，那么你可以通过"),a("strong",[s._v("runtime")]),s._v("指定，本项目就是采用了这个方法。到目前为止，VS Code支持"),a("code",[s._v("node")]),s._v("和"),a("code",[s._v("mono")]),s._v("运行时。")])]),s._v(" "),a("li",[a("p",[s._v("如果实现你的调试适配器需要执行在不同平台，那么"),a("strong",[s._v("program")]),s._v("配置可以像下面这样指定：")])])]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"debuggers"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"gdb"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"windows"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"program"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./bin/gdbDebug.exe"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"osx"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"program"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./bin/gdbDebug.sh"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"linux"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"program"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./bin/gdbDebug.sh"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("ol",{attrs:{start:"3"}},[a("li",[s._v("组合上面的两种方式也是可行的。下面是一个Mono Debug适配器，只需要macOs和Linux，而不需要Windows支持。")])]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"debuggers"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mono"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"program"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./bin/monoDebug.exe"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"osx"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"runtime"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mono"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"linux"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"runtime"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mono"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[a("strong",[s._v("configurationAttributes")]),s._v("表示这个调试器是支持"),a("code",[s._v("launch.json")]),s._v("配置，开启之后它会校验"),a("code",[s._v("launch.json")]),s._v("。另外这个属性还会启用：编辑"),a("em",[s._v("启动配置")]),s._v("文件时的智能提示和悬浮帮助文本。")]),s._v(" "),a("p",[a("strong",[s._v("initialConfigurations")]),s._v("定义了"),a("code",[s._v("launch.json")]),s._v("的初始默认内容。以便于项目不包含"),a("code",[s._v("launch.json")]),s._v("文件时，用户打开调试或者按下调试侧边栏的齿轮按钮后仍能启动调试会话，VS Code会让用户选择一个调试环境，然后生成对应的"),a("code",[s._v("launch.json")]),s._v("：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/Microsoft/vscode-docs/master/docs/extensions/images/example-debuggers/debug-init-config.png",alt:""}})]),s._v(" "),a("p",[a("strong",[s._v("configurationSnippets")]),s._v("定义了编辑"),a("code",[s._v("launch.json")]),a("em",[s._v("启动配置")]),s._v("文件的配置补全。方便起见，给调试环境名称加上"),a("code",[s._v("label")]),s._v("前缀以便于补全下拉框出现时能快速地找到我们的目标。")]),s._v(" "),a("p",[a("strong",[s._v("variables")]),s._v('字段将"variables"绑定到了"commands"，用**${command:Xxxx}**语法在'),a("em",[s._v("启动配置")]),s._v("中使用这些变量，调试会话启动后这些值会被替换掉。")]),s._v(" "),a("p",[s._v("命令是在插件中实现的，它可既可以提供简单的无界面实现，也可以通过插件API提供界面中的复杂功能点。Mock Debug将"),a("code",[s._v("AskForProgramName")]),s._v("变量绑定到"),a("code",[s._v("extension.mock-debug.getProgramName")]),s._v("命令上。这个命令的"),a("a",{attrs:{href:"https://github.com/Microsoft/vscode-mock-debug/blob/431857ca27e618e2e7164628ff41fa8cedd01bff/src/extension.ts#L33",target:"_blank",rel:"noopener noreferrer"}},[s._v("实现"),a("OutboundLink")],1),s._v("在"),a("code",[s._v("src/extension.ts")]),s._v("中，让用户用"),a("code",[s._v("showInputBox")]),s._v("输入程序的名称。")]),s._v(" "),a("div",{staticClass:"language-typescript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-typescript"}},[a("code",[s._v("vscode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("commands"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("registerCommand")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'extension.mock-debug.getProgramName'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("config")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" vscode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("showInputBox")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        placeHolder"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Please enter the name of a markdown file in the workspace folder"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        value"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"readme.md"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("这个变量可以用**${command:AskForProgramName}**形式注入到任何"),a("em",[s._v("加载配置")]),s._v("允许字符串类型的地方。")]),s._v(" "),a("h2",{attrs:{id:"使用debugconfigurationprovider"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用debugconfigurationprovider"}},[s._v("#")]),s._v(" 使用DebugConfigurationProvider")]),s._v(" "),a("hr"),s._v(" "),a("p",[s._v("如果"),a("code",[s._v("package.json")]),s._v("中的静态调试"),a("em",[s._v("发布配置内容")]),s._v("不够，那"),a("code",[s._v("DebugConfigurationProvider")]),s._v("就派上用场了，它能动态控制调试插件的下列内容：")]),s._v(" "),a("ul",[a("li",[s._v("动态生成launch.json中的debug配置，例如：基于一些工作区可用的上下文信息。")]),s._v(" "),a("li",[s._v("启动新的调试会话前“解析”"),a("em",[s._v("加载配置")]),s._v("，比如根据工作区的一些信息填充默认值。")]),s._v(" "),a("li",[s._v("动态计算调试适配器的可执行路径或者其他命令行参数。")])]),s._v(" "),a("p",[a("code",[s._v("src/extension.ts")]),s._v("中的"),a("code",[s._v("MockConfigurationProvider")]),s._v("实现了"),a("code",[s._v("resolveDebugConfiguration")]),s._v("，如果Markdown文件打开而启动调试会话后检测是否有launch.json文件存在。这是一个非常典型的用户场景，用户在编辑器内打开了文件，想要调试的时候却发现没有launch.json文件。")]),s._v(" "),a("p",[a("code",[s._v("vscode.debug.registerDebugConfigurationProvider")]),s._v("是一个调试供应器（debug configuration provider）注册的特殊调试类型，一般出现在"),a("code",[s._v("activate")]),s._v("函数中。为了确保"),a("code",[s._v("DebugConfigurationProvider")]),s._v("尽早注册，插件必须在调试功能启动之前就激活，我们可以在"),a("code",[s._v("package.json")]),s._v("的"),a("code",[s._v("onDebug")]),s._v("事件中配置插件激活事件：")]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"activationEvents"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"onDebug"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ...")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("这个总的"),a("code",[s._v("onDebug")]),s._v("事件在调试功能一启动就会被调用。如果插件的启动开销不大（如：启动时不要花太多时间）那就会运行正常。如果调试插件的启动开销很大（如：启动一个语言服务器），那么"),a("code",[s._v("onDebug")]),s._v("激活事件就会对其他调试插件产生负面影响了，因为它只想尽早启动，而不会把其他类型的调试器考虑在内。")]),s._v(" "),a("p",[s._v("对于高开销调试插件的更好办法是用粒度更细的激活事件：")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("onDebugInitialConfigurations")]),s._v("：在"),a("code",[s._v("DebugConfigurationProvider")]),s._v("的"),a("code",[s._v("provideDebugConfigurations")]),s._v("调用前触发。")]),s._v(" "),a("li",[a("code",[s._v("onDebugResolve:type")]),s._v("：在"),a("code",[s._v("DebugConfigurationProvider")]),s._v("的"),a("code",[s._v("resolveDebugConfiguration")]),s._v("调用前触发。")])]),s._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[s._v("首要准则")]),s._v(" "),a("p",[s._v("如果插件的开销不大，就用"),a("code",[s._v("onDebug")]),s._v("。如果插件的开销比较高，根据"),a("code",[s._v("DebugConfigurationProvider")]),s._v("是否调用"),a("code",[s._v("provideDebugConfigurations")]),s._v("或"),a("code",[s._v("resolveDebugConfiguration")]),s._v("，在对应的"),a("code",[s._v("onDebugInitialConfigurations")]),s._v("或者"),a("code",[s._v("onDebugResolve")]),s._v("中处理。")])]),s._v(" "),a("h2",{attrs:{id:"发布你的调试适配器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#发布你的调试适配器"}},[s._v("#")]),s._v(" 发布你的调试适配器")]),s._v(" "),a("hr"),s._v(" "),a("p",[s._v("通过下面的步骤将你的调试适配器发布到市场上：")]),s._v(" "),a("ul",[a("li",[s._v("更新"),a("code",[s._v("package.json")]),s._v("中的发布配置内容表明你调试适配器的功能和目标")]),s._v(" "),a("li",[s._v("根据"),a("a",{attrs:{href:"https://github.com/Microsoft/vscode-docs/blob/master/docs/extensions/publish-extension.md",target:"_blank",rel:"noopener noreferrer"}},[s._v("分享插件"),a("OutboundLink")],1),s._v("部分把你的插件上传到市场上")])]),s._v(" "),a("h2",{attrs:{id:"可选方案：开发一个调试插件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#可选方案：开发一个调试插件"}},[s._v("#")]),s._v(" 可选方案：开发一个调试插件")]),s._v(" "),a("hr"),s._v(" "),a("p",[s._v("开发调试插件一般既包含插件，也包含"),a("em",[s._v("调试器")]),s._v("和"),a("em",[s._v("调试适配器")]),s._v("这两个平行session。就如上面解释的，VS Code对一点支持非常友好，不过如果想要开发得更容易的话，还是把插件和调试适配器放在一个程序里，用一个会话启动更方便些。")]),s._v(" "),a("p",[s._v("当你在使用Typescript/Javascript实现调试适配器的时候会更容易。")]),s._v(" "),a("p",[s._v("基本的思路是在"),a("code",[s._v("DebugConfigurationProvider")]),s._v("的"),a("code",[s._v("resolveDebugConfiguration")]),s._v("方法中拦截调试会话的加载，然后对"),a("em",[s._v("连接请求")]),s._v("就行侦听，对每一个请求创建新的调试适配器会话。为了确保VS Code使用"),a("em",[s._v("连接请求")]),s._v("（而不是总是加载新的调试适配器），可以修改"),a("em",[s._v("加载配置")]),s._v("，加上"),a("code",[s._v("debugServer")]),s._v("。")]),s._v(" "),a("p",[s._v("这是几行"),a("strong",[s._v("Mock Debug")]),s._v("项目"),a("a",{attrs:{href:"https://github.com/Microsoft/vscode-mock-debug/blob/042d19a27a8e3a08f27a24110506b53fbecc75ce/src/extension.ts#L61-L71",target:"_blank",rel:"noopener noreferrer"}},[s._v("实现的这个方法的代码"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("通过将编译时间标识"),a("code",[s._v("EMBED_DEBUG_ADAPTER")]),s._v("设置为true启用这个特性。现在如果你用"),a("strong",[s._v("F5")]),s._v("启动调试，你不仅仅可以插件中打断点了，调试器适配器里也同样可以。")])])}),[],!1,null,null,null);t.default=e.exports}}]);